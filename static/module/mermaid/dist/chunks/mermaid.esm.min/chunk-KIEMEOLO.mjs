import{a as ce}from"./chunk-XE64DKBQ.mjs";import{Ca as F,Fa as O,Ga as k,Ha as N,Ia as _,Ja as j,Ka as A,L as v,La as H,Ma as z,Na as I,Oa as U,Pa as X,Qa as Y,Ra as J,Sa as V,Ta as q,Ua as Z,Va as G,Wa as K,Xa as Q,b as d,e as m,ga as R,h as L,k as w,t as D}from"./chunk-LXRGKPZR.mjs";import{T as ee,k as b}from"./chunk-YLAFDWD2.mjs";import{a,e as ae}from"./chunk-CPXVQKWD.mjs";var re=ae(ce(),1);var ue="\u200B",le={curveBasis:N,curveBasisClosed:_,curveBasisOpen:j,curveBumpX:O,curveBumpY:k,curveBundle:A,curveCardinalClosed:z,curveCardinalOpen:I,curveCardinal:H,curveCatmullRomClosed:X,curveCatmullRomOpen:Y,curveCatmullRom:U,curveLinear:F,curveLinearClosed:J,curveMonotoneX:V,curveMonotoneY:q,curveNatural:Z,curveStep:G,curveStepAfter:Q,curveStepBefore:K},fe=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,ge=a(function(t,e){let r=ie(t,/(?:init\b)|(?:initialize\b)/),n={};if(Array.isArray(r)){let s=r.map(u=>u.args);D(s),n=w(n,[...s])}else n=r.args;if(!n)return;let i=L(t,e),o="config";return n[o]!==void 0&&(i==="flowchart-v2"&&(i="flowchart"),n[i]=n[o],delete n[o]),n},"detectInit"),ie=a(function(t,e=null){try{let r=new RegExp(`[%]{2}(?![{]${fe.source})(?=[}][%]{2}).*
`,"ig");t=t.trim().replace(r,"").replace(/'/gm,'"'),d.debug(`Detecting diagram directive${e!==null?" type:"+e:""} based on the text:${t}`);let n,i=[];for(;(n=m.exec(t))!==null;)if(n.index===m.lastIndex&&m.lastIndex++,n&&!e||e&&n[1]?.match(e)||e&&n[2]?.match(e)){let o=n[1]?n[1]:n[2],s=n[3]?n[3].trim():n[4]?JSON.parse(n[4].trim()):null;i.push({type:o,args:s})}return i.length===0?{type:t,args:null}:i.length===1?i[0]:i}catch(r){return d.error(`ERROR: ${r.message} - Unable to parse directive type: '${e}' based on the text: '${t}'`),{type:void 0,args:null}}},"detectDirective"),ze=a(function(t){return t.replace(m,"")},"removeDirectives"),de=a(function(t,e){for(let[r,n]of e.entries())if(n.match(t))return r;return-1},"isSubstringInArray");function he(t,e){if(!t)return e;let r=`curve${t.charAt(0).toUpperCase()+t.slice(1)}`;return le[r]??e}a(he,"interpolateToCurve");function me(t,e){let r=t.trim();if(r)return e.securityLevel!=="loose"?(0,re.sanitizeUrl)(r):r}a(me,"formatUrl");var pe=a((t,...e)=>{let r=t.split("."),n=r.length-1,i=r[n],o=window;for(let s=0;s<n;s++)if(o=o[r[s]],!o){d.error(`Function name: ${t} not found in window`);return}o[i](...e)},"runFunc");function oe(t,e){return!t||!e?0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}a(oe,"distance");function xe(t){let e,r=0;t.forEach(i=>{r+=oe(i,e),e=i});let n=r/2;return T(t,n)}a(xe,"traverseEdge");function ye(t){return t.length===1?t[0]:xe(t)}a(ye,"calcLabelPosition");var te=a((t,e=2)=>{let r=Math.pow(10,e);return Math.round(t*r)/r},"roundNumber"),T=a((t,e)=>{let r,n=e;for(let i of t){if(r){let o=oe(i,r);if(o===0)return r;if(o<n)n-=o;else{let s=n/o;if(s<=0)return r;if(s>=1)return{x:i.x,y:i.y};if(s>0&&s<1)return{x:te((1-s)*r.x+s*i.x,5),y:te((1-s)*r.y+s*i.y,5)}}}r=i}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),ve=a((t,e,r)=>{d.info(`our points ${JSON.stringify(e)}`),e[0]!==r&&(e=e.reverse());let i=T(e,25),o=t?10:5,s=Math.atan2(e[0].y-i.y,e[0].x-i.x),u={x:0,y:0};return u.x=Math.sin(s)*o+(e[0].x+i.x)/2,u.y=-Math.cos(s)*o+(e[0].y+i.y)/2,u},"calcCardinalityPosition");function be(t,e,r){let n=structuredClone(r);d.info("our points",n),e!=="start_left"&&e!=="start_right"&&n.reverse();let i=25+t,o=T(n,i),s=10+t*.5,u=Math.atan2(n[0].y-o.y,n[0].x-o.x),c={x:0,y:0};return e==="start_left"?(c.x=Math.sin(u+Math.PI)*s+(n[0].x+o.x)/2,c.y=-Math.cos(u+Math.PI)*s+(n[0].y+o.y)/2):e==="end_right"?(c.x=Math.sin(u-Math.PI)*s+(n[0].x+o.x)/2-5,c.y=-Math.cos(u-Math.PI)*s+(n[0].y+o.y)/2-5):e==="end_left"?(c.x=Math.sin(u)*s+(n[0].x+o.x)/2-5,c.y=-Math.cos(u)*s+(n[0].y+o.y)/2-5):(c.x=Math.sin(u)*s+(n[0].x+o.x)/2,c.y=-Math.cos(u)*s+(n[0].y+o.y)/2),c}a(be,"calcTerminalLabelPosition");function Ce(t){let e="",r="";for(let n of t)n!==void 0&&(n.startsWith("color:")||n.startsWith("text-align:")?r=r+n+";":e=e+n+";");return{style:e,labelStyle:r}}a(Ce,"getStylesFromArray");var ne=0,Me=a(()=>(ne++,"id-"+Math.random().toString(36).substr(2,12)+"-"+ne),"generateId");function we(t){let e="",r="0123456789abcdef",n=r.length;for(let i=0;i<t;i++)e+=r.charAt(Math.floor(Math.random()*n));return e}a(we,"makeRandomHex");var Pe=a(t=>we(t.length),"random"),Te=a(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),$e=a(function(t,e){let r=e.text.replace(v.lineBreakRegex," "),[,n]=S(e.fontSize),i=t.append("text");i.attr("x",e.x),i.attr("y",e.y),i.style("text-anchor",e.anchor),i.style("font-family",e.fontFamily),i.style("font-size",n),i.style("font-weight",e.fontWeight),i.attr("fill",e.fill),e.class!==void 0&&i.attr("class",e.class);let o=i.append("tspan");return o.attr("x",e.x+e.textMargin*2),o.attr("fill",e.fill),o.text(r),i},"drawSimpleText"),Se=b((t,e,r)=>{if(!t||(r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},r),v.lineBreakRegex.test(t)))return t;let n=t.split(" ").filter(Boolean),i=[],o="";return n.forEach((s,u)=>{let c=M(`${s} `,r),l=M(o,r);if(c>e){let{hyphenatedStrings:h,remainingWord:f}=We(s,e,"-",r);i.push(o,...h),o=f}else l+c>=e?(i.push(o),o=s):o=[o,s].filter(Boolean).join(" ");u+1===n.length&&i.push(o)}),i.filter(s=>s!=="").join(r.joinWith)},(t,e,r)=>`${t}${e}${r.fontSize}${r.fontWeight}${r.fontFamily}${r.joinWith}`),We=b((t,e,r="-",n)=>{n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},n);let i=[...t],o=[],s="";return i.forEach((u,c)=>{let l=`${s}${u}`;if(M(l,n)>=e){let x=c+1,h=i.length===x,f=`${l}${r}`;o.push(h?l:f),s=""}else s=l}),{hyphenatedStrings:o,remainingWord:s}},(t,e,r="-",n)=>`${t}${e}${r}${n.fontSize}${n.fontWeight}${n.fontFamily}`);function Ee(t,e){return $(t,e).height}a(Ee,"calculateTextHeight");function M(t,e){return $(t,e).width}a(M,"calculateTextWidth");var $=b((t,e)=>{let{fontSize:r=12,fontFamily:n="Arial",fontWeight:i=400}=e;if(!t)return{width:0,height:0};let[,o]=S(r),s=["sans-serif",n],u=t.split(v.lineBreakRegex),c=[],l=R("body");if(!l.remove)return{width:0,height:0,lineHeight:0};let p=l.append("svg");for(let h of s){let f=0,g={width:0,height:0,lineHeight:0};for(let se of u){let E=Te();E.text=se||ue;let B=$e(p,E).style("font-size",o).style("font-weight",i).style("font-family",h),y=(B._groups||B)[0][0].getBBox();if(y.width===0&&y.height===0)throw new Error("svg element not in render tree");g.width=Math.round(Math.max(g.width,y.width)),f=Math.round(y.height),g.height+=f,g.lineHeight=Math.round(Math.max(g.lineHeight,f))}c.push(g)}p.remove();let x=isNaN(c[1].height)||isNaN(c[1].width)||isNaN(c[1].lineHeight)||c[0].height>c[1].height&&c[0].width>c[1].width&&c[0].lineHeight>c[1].lineHeight?0:1;return c[x]},(t,e)=>`${t}${e.fontSize}${e.fontWeight}${e.fontFamily}`),W=class W{constructor(e=!1,r){this.count=0;this.count=r?r.length:0,this.next=e?()=>this.count++:()=>Date.now()}};a(W,"InitIDGenerator");var P=W,C,Be=a(function(t){return C=C||document.createElement("div"),t=escape(t).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),C.innerHTML=t,unescape(C.textContent)},"entityDecode");function Ie(t){return"str"in t}a(Ie,"isDetailedError");var Le=a((t,e,r,n)=>{if(!n)return;let i=t.node()?.getBBox();i&&t.append("text").text(n).attr("text-anchor","middle").attr("x",i.x+i.width/2).attr("y",-r).attr("class",e)},"insertTitle"),S=a(t=>{if(typeof t=="number")return[t,t+"px"];let e=parseInt(t??"",10);return Number.isNaN(e)?[void 0,void 0]:t===String(e)?[e,t+"px"]:[e,t]},"parseFontSize");function De(t,e){return ee({},t,e)}a(De,"cleanAndMerge");var Ue={assignWithDepth:w,wrapLabel:Se,calculateTextHeight:Ee,calculateTextWidth:M,calculateTextDimensions:$,cleanAndMerge:De,detectInit:ge,detectDirective:ie,isSubstringInArray:de,interpolateToCurve:he,calcLabelPosition:ye,calcCardinalityPosition:ve,calcTerminalLabelPosition:be,formatUrl:me,getStylesFromArray:Ce,generateId:Me,random:Pe,runFunc:pe,entityDecode:Be,insertTitle:Le,parseFontSize:S,InitIDGenerator:P},Xe=a(function(t){let e=t;return e=e.replace(/style.*:\S*#.*;/g,function(r){return r.substring(0,r.length-1)}),e=e.replace(/classDef.*:\S*#.*;/g,function(r){return r.substring(0,r.length-1)}),e=e.replace(/#\w+;/g,function(r){let n=r.substring(1,r.length-1);return/^\+?\d+$/.test(n)?"\uFB02\xB0\xB0"+n+"\xB6\xDF":"\uFB02\xB0"+n+"\xB6\xDF"}),e},"encodeEntities"),Ye=a(function(t){return t.replace(/ﬂ°°/g,"&#").replace(/ﬂ°/g,"&").replace(/¶ß/g,";")},"decodeEntities");var Je=a((t,e,{counter:r=0,prefix:n,suffix:i},o)=>o||`${n?`${n}_`:""}${t}_${e}_${r}${i?`_${i}`:""}`,"getEdgeId");function Ve(t){return t??null}a(Ve,"handleUndefinedAttr");export{ue as a,ze as b,he as c,Ce as d,Me as e,Pe as f,Se as g,Ee as h,M as i,Ie as j,S as k,De as l,Ue as m,Xe as n,Ye as o,Je as p,Ve as q};
